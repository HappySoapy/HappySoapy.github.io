---
layout: post
title:  North Wind Data Analysis
date:   2021-05-31
image:  /assets/images/post4/north_wind_analysis.jpg
author: yelim
---
<p>&nbsp;</p>
<p><span style="font-size: 15pt; color: #e03e2d;">구글 애널리틱스, Tableau 등을 사용해서 코호트 분석을 하는 방법도 있으나 SQL 코드를 직접 짜서 시도해 보고 싶었다.</span></p>
<p>North Wind Traders는 한 테이블 당 존재하는 행은 적으나 테이블 간의 연결 및 ERD를 이해하기 좋은 데이터이기에 선택했다.</p>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 20pt;"><strong><span style="color: #236fa1;">Introduce</span></strong></span></p>
<p style="padding-left: 40px;">Goal : 고객의 구매 패턴 분석</p>
<p style="padding-left: 40px;">Platform : Redash</p>
<p style="padding-left: 40px;">Tool : SQL</p>
<p style="padding-left: 40px;">Data : 20 Tables with 177 Columns</p>
<p>&nbsp;</p>
<p><span style="font-size: 20pt;"><strong><span style="color: #236fa1;">Main ERD</span></strong></span></p>
<p style="text-align:center;"><img src="/assets/images/post4/erd.png" alt="result" style="width:90%;" /></p>
<p>&nbsp;</p>
<p><span style="font-size: 20pt;"><strong><span style="color: #236fa1;">Cohort Analysis</span></strong></span></p>
<p style="text-align:center;"><img src="/assets/images/post4/eda7.png" alt="result" style="width:60%;" /></p>



<p style="line-height: 14pt; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; word-break: keep-all; padding-left: 40px;">&nbsp;</p>
<p style="line-height: 14pt; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; word-break: keep-all; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: black;">첫 달 </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">구매고객의</span><span style="font-family: '에스코어 드림 3 Light'; color: black;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">재구매율에</span><span style="font-family: '에스코어 드림 3 Light'; color: black;"> 대한 </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">코호트</span><span style="font-family: '에스코어 드림 3 Light'; color: black;"> 분석</span></span></p>
<ul>
<li style="list-style-type: none;">
<ul>
<li><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #0d0d0d;">보통 </span><span style="font-family: '에스코어 드림 3 Light'; color: #0d0d0d;">코호트</span><span style="font-family: '에스코어 드림 3 Light'; color: #0d0d0d;"> 분석을 할 때 첫 </span><span style="font-family: '에스코어 드림 3 Light'; color: #0d0d0d;">구매월을</span><span style="font-family: '에스코어 드림 3 Light'; color: #0d0d0d;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #0d0d0d;">0</span><span style="font-family: '에스코어 드림 3 Light'; color: #0d0d0d;">으로 표시하지만</span><span style="font-family: '에스코어 드림 3 Light'; color: #0d0d0d;">,</span><span style="font-family: '에스코어 드림 3 Light'; color: #0d0d0d;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: red;">Redash</span><span style="font-family: '에스코어 드림 3 Light'; color: red;">의 시각화 툴을 사용했을 때에는 첫 </span><span style="font-family: '에스코어 드림 3 Light'; color: red;">구매월을</span><span style="font-family: '에스코어 드림 3 Light'; color: red;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: red;">1</span><span style="font-family: '에스코어 드림 3 Light'; color: red;">로 </span><span style="font-family: '에스코어 드림 3 Light'; color: red;">표시함</span><span style="font-family: '에스코어 드림 3 Light'; color: red;">.</span></span></li>
<li><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: black;">2006</span><span style="font-family: '에스코어 드림 3 Light'; color: black;">년 </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">5</span><span style="font-family: '에스코어 드림 3 Light'; color: black;">월과 </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">6</span><span style="font-family: '에스코어 드림 3 Light'; color: black;">월에 첫 구매한 고객이 없어서</span><span style="font-family: '에스코어 드림 3 Light'; color: black;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">즉</span><span style="font-family: '에스코어 드림 3 Light'; color: black;">, 2006</span><span style="font-family: '에스코어 드림 3 Light'; color: black;">년 </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">4</span><span style="font-family: '에스코어 드림 3 Light'; color: black;">월에 첫 구매한 고객이 </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">5</span><span style="font-family: '에스코어 드림 3 Light'; color: black;">월</span><span style="font-family: '에스코어 드림 3 Light'; color: black;">, 6</span><span style="font-family: '에스코어 드림 3 Light'; color: black;">월에 </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">재구매한</span><span style="font-family: '에스코어 드림 3 Light'; color: black;"> 고객은 있어도 첫 구매한 고객이 없기 때문에 위 표의 </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">Time </span><span style="font-family: '에스코어 드림 3 Light'; color: black;">열에 표시되지 않은 것으로 보임.</span></span></li>
</ul>
</li>
</ul>
<p style="line-height: 14pt; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; word-break: keep-all; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">&gt; 결과 분석</span></span></p>
<p style="line-height: 14pt; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; word-break: keep-all; padding-left: 80px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">1. 첫 구매 후 2개월 뒤 재구매율이 높음. 이익을 더 창출하고자 한다면 1개월로 줄이도록 마케팅하는 것이 좋을 것으로 보임.</span></span></p>
<p style="line-height: 14pt; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; word-break: keep-all; padding-left: 80px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">2. 첫 구매 후 시간이 지날 수록 재구매율이 낮아지고 있는데, 이를 보완하기 위한 타임 세일이나 컴백쿠폰 등의 마케팅이 필요한 것으로 보임.</span></span></p>
<p style="line-height: 14pt; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; word-break: keep-all; padding-left: 40px;">&nbsp;</p>





<p>&nbsp;</p>
<p>&nbsp;</p>
<p style="padding-left: 40px;">&nbsp;</p>
<p><strong><span style="font-size: 20pt; color: #236fa1;">Dash Board</span></strong></p>
<p style="text-align:center;"><img src="/assets/images/post4/dashboard.png" alt="result" style="width:90%;" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="c
olor: #236fa1;"><strong><span style="font-size: 20pt;">Codes for Cohort Analysis</span></strong></span></p>
<table style="border-collapse: collapse; width: 88.9791%; height: 593px;" border="1">
<tbody>
<tr>
<td style="width: 100%;">
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">select</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">new_tbl2.cohort, new_tbl2.ordered_date</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">, </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">new_tbl2.n_customers, </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">new_tbl2.total_price</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">,</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;">#</span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;">가장 어려웠던 부분</span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;">. </span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;">첫 </span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;">구매월과</span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;">재구매월의</span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;"> 차이를 구하는 부분</span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;">.</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp; round(</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">timestampdifF</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">(month, </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">str_to_date</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">(</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">concat</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">(new_tbl2.cohort, '-',&nbsp; '01'), '%Y-%m-%d'), </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">str_to_date</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">(</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">concat</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">(new_tbl2.ordered_date</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">, '-',&nbsp; '01'), '%Y-%m-%d'))) </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">period&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt; font-family: '에스코어 드림 3 Light'; color: #0070c0;">from</span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt; font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp; (</span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">select</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">new_tbl.cohort</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">, </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">date_format</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">(</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">o.order_date</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">, '%Y-%m') </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">ordered_date</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">, </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count(distinct </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">o.customer_id</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">) </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">n_customers</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">,</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum(</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">od.quantity</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">*</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">od.unit_price</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">) </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">total_price</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">from</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt; font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; orders o</span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">left</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">join</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt; font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">select</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">o.customer_id</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">, </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; min(o.id) </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">order_id</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">, </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">date_format</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">(min(</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">o.order_date</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">), '%Y-%m') cohort</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">from</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> orders o</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">group</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">by</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">o.customer_id</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ) </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">new_tbl</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;"># </span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;">첫 번째 테이블</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">on</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">o.customer_id</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">=</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">new_tbl.customer_id</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">left</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">join</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">order_details</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> od </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">on</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">o.id=</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">od.order_id</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">group</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span><span style="font-family: '에스코어 드림 3 Light'; color: #0070c0;">by</span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;"> </span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cohort, </span><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">ordered_date</span></span></p>
<p style="margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; text-align: left; direction: ltr; unicode-bidi: embed; padding-left: 40px;"><span style="font-size: 12pt;"><span style="font-family: '에스코어 드림 3 Light'; color: #595959;">&nbsp;&nbsp;&nbsp; ) new_tbl2;&nbsp; </span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;"># </span><span style="font-family: '에스코어 드림 3 Light'; color: #385723;">두 번째 테이블</span></span></p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>